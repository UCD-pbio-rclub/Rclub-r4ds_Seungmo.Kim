---
title: "Notebook_05022017"
output: html_notebook
---

```{r}
library(tidyverse)
```
### 3.6 Geometric objects
```{r}
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy))

ggplot(data = mpg) + 
  geom_smooth(mapping = aes(x = displ, y = hwy))

ggplot(data = mpg) +
  geom_smooth(mapping = aes(x = displ, y = hwy, group = drv))

ggplot(data = mpg) + 
  geom_smooth(mapping = aes(x = displ, y = hwy, linetype = drv))
```
```{r}
ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) + 
  geom_point() + 
  geom_smooth()

ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) + 
  geom_point(mapping = aes(color = class)) + 
  geom_smooth()

ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) + 
  geom_point(mapping = aes(color = class)) + 
  geom_smooth(data = filter(mpg, class == "subcompact"), se = FALSE)
```
### 3.6.1 Exercises

##### 1. What geom would you use to draw a line chart? A boxplot? A histogram? An area chart?
```{r}
p <- ggplot(data = mpg, mapping = aes(x = displ, y = hwy))
p + geom_line()
p + geom_boxplot()
q <- ggplot(data = mpg, mapping = aes(x = displ))
q + geom_histogram()
q + geom_area()
```

  + 
  geom_smooth(se = FALSE)

##### 2. Run this code in your head and predict what the output will look like. Then, run the code in R and check your predictions.
```{r}
ggplot(data = mpg, mapping = aes(x = displ, y = hwy, color = drv)) + 
  geom_point() + 
  geom_smooth(se = FALSE)
```
##### 5. What does show.legend = FALSE do? What happens if you remove it?
Why do you think I used it earlier in the chapter?
```{r}
ggplot(data = mpg, mapping = aes(x = displ, y = hwy, color = drv)) + 
  geom_point() + 
  geom_smooth()
```
#### 6. Recreate the R code necessary to generate the following graphs.
```{r}
ggplot(data = mpg, mapping = aes(x = displ, y = hwy), color = "blue") + 
  geom_point() + 
  geom_smooth()
```
```{r}
ggplot(data = mpg, mapping = aes(x = displ, y = hwy, group=drv)) + 
  geom_point() + 
  geom_smooth(se=FALSE)
```
```{r}
ggplot(data = mpg, mapping = aes(x = displ, y = hwy, color=drv)) + 
  geom_point() + 
  geom_smooth(se=FALSE)
```
```{r}
ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) + 
  geom_point(mapping = aes(color = drv)) + 
  geom_smooth(color="blue")
```
```{r}
ggplot(data = mpg, mapping = aes(x = displ, y = hwy, color=drv)) + 
  geom_point() + 
  geom_smooth(se=FALSE)
```
```{r}
ggplot(data = mpg, mapping = aes(x = displ, y = hwy, color=drv)) + 
  geom_point() + 
  geom_
```
```{r}

```

```{r}

```
### 3.7 Statistical transformations

```{r}
ggplot(data = diamonds) + 
  geom_bar(mapping = aes(x = cut))

ggplot(data = diamonds) + 
  stat_count(mapping = aes(x = cut))
```
```{r}
demo <- tribble(
  ~a,      ~b,
  "bar_1", 20,
  "bar_2", 30,
  "bar_3", 40
)

ggplot(data = demo) +
  geom_bar(mapping = aes(x = a, y = b), stat = "identity")
```

```{r}
ggplot(data = diamonds) + 
  geom_bar(mapping = aes(x = cut, y = ..prop.., group = 1))
```
```{r}
ggplot(data = diamonds) + 
  stat_summary(
    mapping = aes(x = cut, y = depth),
    fun.ymin = min,
    fun.ymax = max,
    fun.y = median
  )
```
### 3.7.1 Exercises

##### 1. What is the default geom associated with stat_summary()? How could you rewrite the previous plot to use that geom function instead of the stat function?
```{r}
ggplot(data = diamonds, mapping = aes(x = cut, y = depth)) + geom_line(stat="summary")
  stat_summary(
    mapping = aes(x = cut, y = depth),
    fun.ymin = min,
    fun.ymax = max,
    fun.y = median
  )
```


##### 2. What does geom_col() do? How is it different to geom_bar()?
for bar charts 
1) geom_bar: makes the height of the bar proportional to the number of cases in each group, using stat_count by default(counts the number of cases at each x position)
2) geom_col: makes the heights of the bars to represent values in the data, using stat_identity(leaves the data as is)


##### 3. Most geoms and stats come in pairs that are almost always used in concert. Read through the documentation and make a list of all the pairs. What do they have in common?


##### 4. What variables does stat_smooth() compute? What parameters control its behaviour?


##### 5. In our proportion bar chart, we need to set group = 1. Why? In other words what is the problem with these two graphs?

ggplot(data = diamonds) + 
  geom_bar(mapping = aes(x = cut, y = ..prop.., group=1))
ggplot(data = diamonds) + 
  geom_bar(mapping = aes(x = cut, fill = color, y = ..prop.., group =1))
  
  
### 3.8 Position adjustments(bar chart)

```{r}
ggplot(data = diamonds) + 
  geom_bar(mapping = aes(x = cut, fill = cut))

ggplot(data = diamonds) + 
  geom_bar(mapping = aes(x = cut, fill = clarity))
```
```{r}
# position = "fill" works like stacking, but makes each set of stacked bars the same height. This makes it easier to compare proportions across groups.
ggplot(data = diamonds) + 
  geom_bar(mapping = aes(x = cut, fill = clarity), position = "fill")

# position = "dodge" places overlapping objects directly beside one another. This makes it easier to compare individual values.
ggplot(data = diamonds) + 
  geom_bar(mapping = aes(x = cut, fill = clarity), position = "dodge")

ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy), position = "jitter")
```
### 3.8.1 Exercises

##### 1. What is the problem with this plot? How could you improve it?
```{r}
ggplot(data = mpg, mapping = aes(x = cty, y = hwy)) + 
  geom_point(position="jitter")
# This spreads the points out because no two points are likely to receive the same amount of random noise.
# Adding randomness seems like a strange way to improve your plot, but while it makes your graph less accurate at small scales, it makes your graph more revealing at large scales. 
```

##### 2. What parameters to geom_jitter() control the amount of jittering?
```{r}
ggplot(data = mpg, mapping = aes(x = cty, y = hwy)) + 
  geom_jitter(size=1.5)
```


##### 3. Compare and contrast geom_jitter() with geom_count().
```{r}
ggplot(data = mpg, mapping = aes(x = cty, y = hwy)) + 
  geom_jitter()

ggplot(data = mpg, mapping = aes(x = cty, y = hwy)) + 
  geom_count()
```

##### 4. What’s the default position adjustment for geom_boxplot()? Create a visualisation of the mpg dataset that demonstrates it.

The default adjustment is position_dodge. This means that the points are moved to the side by a discrete amount

p <- ggplot(data = mpg, mapping = aes(x=drv, y=cty)) 
p + geom_boxplot() 
p + geom_boxplot(position='dodge') # the same
p + geom_boxplot(position='identity') # unreadable
p + geom_boxplot(position='jitter') # looks terrible, and unreadable


### 3.9 Coordinate systems




```{r}
# coord_flip() switches the x and y axes. This is useful (for example), if you want horizontal boxplots. It’s also useful for long labels: it’s hard to get them to fit without overlapping on the x-axis.
ggplot(data = mpg, mapping = aes(x = class, y = hwy)) + 
  geom_boxplot()
ggplot(data = mpg, mapping = aes(x = class, y = hwy)) + 
  geom_boxplot() +
  coord_flip()
```

```{r}
# coord_quickmap() sets the aspect ratio correctly for maps. This is very important if you’re plotting spatial data with ggplot2.

install.packages("maps")
library(purrr)
library(maps)
library(ggplot2)
nz <- map_data("nz")

ggplot(nz, aes(long, lat, group = group)) +
  geom_polygon(fill = "white", colour = "black")

ggplot(nz, aes(long, lat, group = group)) +
  geom_polygon(fill = "white", colour = "black") +
  coord_quickmap()
```
```{r}
# coord_polar() uses polar coordinates. Polar coordinates reveal an interesting connection between a bar chart and a Coxcomb chart.
bar <- ggplot(data = diamonds) + 
  geom_bar(
    mapping = aes(x = cut, fill = cut), 
    show.legend = FALSE,
    width = 1
  ) + 
  theme(aspect.ratio = 1) +
  labs(x = NULL, y = NULL)

bar + coord_flip()
bar + coord_polar()
```


